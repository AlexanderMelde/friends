<div class="event-item">
  <div class="event-date">{{ formatDate(event.date) }}</div>
  <div class="event-details">
    <div class="event-title">
      <span class="event-title-text">{{ event.title }}</span>
      <button mat-icon-button (click)="editEvent(event, $event)" class="edit-button" *ngIf="showEditButton">
        <mat-icon>edit</mat-icon>
      </button>
    </div>
    <div class="event-location" *ngIf="event.location">
      <mat-icon class="location-icon">place</mat-icon>
      {{ event.location }}
    </div>
    <div class="event-meta">
      <div class="event-type" 
           *ngIf="event.type" 
           (click)="filterByType(event.type, $event)"
           [class.active]="isTypeSelected(event.type)">
        {{ event.type }}
      </div>
      <div class="attendee-avatars" 
           *ngIf="attendees().length > 0"
           [class.drop-zone]="isDragOver"
           [class.drag-active]="isDragging()"
           [class.drag-hover]="isDragOver && isDragging()"
           [class.drag-source]="isDragSource()"
           (dragover)="onDragOver($event)"
           (dragleave)="onDragLeave($event)"
           (drop)="onDrop($event)">
        
        <!-- Show placeholder when dragging from this event -->
        <div *ngIf="isDragSource() && dragService.draggedFriend() as draggedFriend" 
             class="drag-placeholder"
             [class.move-placeholder]="dragAction() === 'move'"
             [class.delete-placeholder]="dragAction() === 'delete'">
          <mat-icon>{{ dragAction() === 'move' ? 'swap_horiz' : 'delete' }}</mat-icon>
          <span class="placeholder-text">
            {{ dragAction() === 'move' ? 'Moving...' : 'Removing...' }}
          </span>
        </div>
        
        <!-- Regular attendee avatars (hide the one being dragged) -->
        <img *ngFor="let attendee of attendees()" 
             [src]="attendee.photoUrl" 
             [alt]="attendee.name"
             [title]="attendee.name"
             class="attendee-avatar"
             [class.being-dragged]="isDragSource() && dragService.draggedFriend()?.id === attendee.id"
             draggable="true"
             (click)="selectAttendee(attendee, $event)"
             (dragstart)="onAttendeeDragStart($event, attendee)"
             (dragend)="onAttendeeDragEnd($event)">
        
        <div class="drop-hint" *ngIf="isDragOver && !isDragSource()">
          <mat-icon>{{ isDraggedFriendAlreadyAttendee() ? 'check' : 'person_add' }}</mat-icon>
        </div>
      </div>
      <div class="attendee-avatars empty-dropzone" 
           *ngIf="attendees().length === 0"
           [class.drop-zone]="isDragOver"
           [class.drag-active]="isDragging()"
           [class.drag-hover]="isDragOver && isDragging()"
           (dragover)="onDragOver($event)"
           (dragleave)="onDragLeave($event)"
           (drop)="onDrop($event)">
        <div class="empty-state" *ngIf="!isDragOver">
          <mat-icon>people_outline</mat-icon>
          <span>No attendees</span>
        </div>
        <div class="drop-hint" *ngIf="isDragOver">
          <mat-icon>{{ isDraggedFriendAlreadyAttendee() ? 'check' : 'person_add' }}</mat-icon>
          <span>{{ isDraggedFriendAlreadyAttendee() ? 'Already attending' : 'Drop to add attendee' }}</span>
        </div>
      </div>
    </div>
  </div>
</div>