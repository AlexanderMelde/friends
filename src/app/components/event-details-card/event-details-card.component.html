<div class="event-details-card">
  <mat-card *ngIf="link">
    <mat-card-header>
      <mat-card-title>{{ connectionTitle }}</mat-card-title>
      <mat-card-subtitle>
        {{ filteredSharedEvents().length }} Shared {{ filteredSharedEvents().length === 1 ? 'Event' : 'Events' }}
      </mat-card-subtitle>
    </mat-card-header>
    
    <mat-card-content>
      <div class="connection-avatars">
        <div class="avatar-container" *ngIf="sourceNode" (click)="selectNode(sourceNode, $event)">
          <img [src]="sourceNode.photoUrl" [alt]="sourceNode.name" class="avatar">
          <span class="avatar-name">{{ sourceNode.name }}</span>
        </div>
        
        <div class="connection-line">
          <span class="connection-count">{{ filteredSharedEvents().length }}</span>
        </div>
        
        <div class="avatar-container" *ngIf="targetNode" (click)="selectNode(targetNode, $event)">
          <img [src]="targetNode.photoUrl" [alt]="targetNode.name" class="avatar">
          <span class="avatar-name">{{ targetNode.name }}</span>
        </div>
      </div>
      
      <!-- Only show divider and events list when there are shared events -->
      <ng-container *ngIf="filteredSharedEvents().length > 0">
        <mat-divider></mat-divider>
        
        <app-events-list
          [events]="filteredSharedEvents()"
          title="Shared Events">
        </app-events-list>
      </ng-container>
    </mat-card-content>
  </mat-card>
</div>